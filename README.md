# GeoVol 3D - Calculadora y Visualizador de VolÃºmenes GeomÃ©tricos

## 1. DescripciÃ³n General
**GeoVol 3D** es una aplicaciÃ³n web moderna tipo SaaS (Software as a Service) desarrollada con React 19. Su objetivo es permitir a ingenieros, estudiantes y diseÃ±adores construir objetos 3D complejos mediante el apilamiento de primitivas geomÃ©tricas, calcular sus propiedades fÃ­sicas en tiempo real y gestionar proyectos en la nube.

## 2. CaracterÃ­sticas Principales

### â˜ï¸ GestiÃ³n de Proyectos (Fase 2)
*   **AutenticaciÃ³n**: Registro e inicio de sesiÃ³n seguro mediante Supabase.
*   **Modo Invitado (Guest Mode)**: Permite probar la herramienta sin registro. Implementa "Guardado Diferido": si un invitado guarda, se preserva su trabajo durante el flujo de registro.
*   **Persistencia**: Guardado de geometrÃ­a, materiales y unidades en base de datos.
*   **Dashboard**: Vista de galerÃ­a con miniaturas de los proyectos.

### ðŸ› ï¸ Herramientas de Modelado
*   **Primitivas**: Cilindro, Cubo, Cono, Esfera, Cono Truncado, PirÃ¡mide, Prisma.
*   **VisualizaciÃ³n Dual**: 
    *   **2D**: Plano tÃ©cnico con acotaciÃ³n automÃ¡tica y auto-zoom reactivo.
    *   **3D**: Renderizado interactivo con Three.js, sombras y etiquetas flotantes (CSS2D).
*   **FÃ­sica**: CÃ¡lculo de Masa (kg) y Peso (N) basado en densidades materiales.

---

## 3. Arquitectura y Patrones de DiseÃ±o

El proyecto utiliza una arquitectura modular basada en componentes funcionales y hooks.

### A. Enrutamiento de Estado (State-Based Routing)
En lugar de `react-router`, `App.tsx` funciona como una **MÃ¡quina de Estados Finita**.
*   **Estados**: `LANDING` -> `AUTH` -> `DASHBOARD` <-> `EDITOR`.
*   **Ventaja**: Permite transiciones fluidas y preservaciÃ³n de memoria (ej. `pendingData`) entre vistas sin recargar la pÃ¡gina.

### B. PatrÃ³n Estrategia (Strategy Pattern)
Ubicado en `utils.ts`. La lÃ³gica de cÃ¡lculo de cada figura estÃ¡ encapsulada en estrategias individuales.
*   **Estructura**: `FIGURE_STRATEGIES` mapea cada `FigureType` a funciones `calculate()` y `getHeight()`.
*   **Escalabilidad**: Para aÃ±adir una nueva figura, solo se agrega una entrada al objeto, cumpliendo el principio Open/Closed.

### C. GestiÃ³n de Estado HÃ­brida
*   **LÃ³gica de Negocio**: ExtraÃ­da al custom hook `useFigureManager` (patrÃ³n Facade para lÃ³gica de estado).
*   **LÃ³gica de UI 3D**: Uso de `refs` en `Viewer3D` para manipulaciÃ³n imperativa de Three.js, evitando re-renderizados de React innecesarios en el bucle de animaciÃ³n.

---

## 4. ConfiguraciÃ³n del Backend (Supabase)

El backend se gestiona con Supabase (PostgreSQL + Auth). Sigue estos pasos para configurarlo:

### 1. Crear Proyecto
RegÃ­strate en [supabase.com](https://supabase.com) y crea un proyecto vacÃ­o.

### 2. Configurar Base de Datos
Ve al **SQL Editor** en tu dashboard de Supabase y ejecuta el siguiente script para crear la tabla y las polÃ­ticas de seguridad:

```sql
-- 1. Tabla de Proyectos
create table projects (
  id bigint generated by default as identity primary key,
  user_id uuid references auth.users not null,
  name text not null,
  description text,
  data jsonb not null,        -- JSON con las figuras y config
  thumbnail text,             -- Imagen Base64 de la vista previa
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  updated_at timestamp with time zone default timezone('utc'::text, now()) not null
);

-- 2. Habilitar RLS (Row Level Security)
alter table projects enable row level security;

-- 3. PolÃ­ticas de Acceso (Solo el dueÃ±o ve sus datos)
create policy "Users can view their own projects" on projects for select using (auth.uid() = user_id);
create policy "Users can insert their own projects" on projects for insert with check (auth.uid() = user_id);
create policy "Users can update their own projects" on projects for update using (auth.uid() = user_id);
create policy "Users can delete their own projects" on projects for delete using (auth.uid() = user_id);
```

### 3. Conectar Cliente
Edita el archivo `src/supabaseClient.ts`:
```typescript
const SUPABASE_URL = 'TU_URL_DEL_PROYECTO';
const SUPABASE_ANON_KEY = 'TU_CLAVE_ANONIMA_PUBLICA';
```

---

## 5. Estructura del Proyecto

```
src/
â”œâ”€â”€ App.tsx                 # [Router] Orquestador principal y manejo de sesiÃ³n.
â”œâ”€â”€ supabaseClient.ts       # [Config] Cliente de conexiÃ³n a la BD.
â”œâ”€â”€ types.ts                # [Types] Definiciones de interfaces (Project, FigureData).
â”œâ”€â”€ utils.ts                # [Logic] CÃ¡lculos matemÃ¡ticos y estrategias.
â”œâ”€â”€ hooks.ts                # [State] Custom Hook para lÃ³gica de Editor (Undo/Redo).
â”‚
â””â”€â”€ components/
    â”œâ”€â”€ Auth.tsx            # [View] Login y Registro.
    â”œâ”€â”€ Dashboard.tsx       # [View] GalerÃ­a de proyectos y CRUD.
    â”œâ”€â”€ Editor.tsx          # [View] Espacio de trabajo principal.
    â”œâ”€â”€ FigureCard.tsx      # [UI] Tarjeta de ediciÃ³n de parÃ¡metros.
    â”œâ”€â”€ LandingPage.tsx     # [View] PÃ¡gina de aterrizaje.
    â”œâ”€â”€ Summary.tsx         # [UI] Panel de resultados fÃ­sicos y exportaciÃ³n.
    â”œâ”€â”€ Viewer2D.tsx        # [Canvas] Visualizador tÃ©cnico con auto-fit.
    â””â”€â”€ Viewer3D.tsx        # [Three.js] Visualizador realista interactivo.
```

---

## 6. InstalaciÃ³n y EjecuciÃ³n

Para ejecutar el proyecto localmente:

### Prerrequisitos
*   Node.js (v16 o superior)
*   NPM o Yarn

### Comandos
1.  **Instalar dependencias**:
    ```bash
    npm install
    ```

2.  **Iniciar servidor de desarrollo**:
    ```bash
    npm start
    ```
    La aplicaciÃ³n estarÃ¡ disponible en `http://localhost:3000` (o el puerto que asigne tu bundler).

3.  **Construir para producciÃ³n**:
    ```bash
    npm run build
    ```

---

## 7. CrÃ©ditos

**DiseÃ±o y Desarrollo**: Daniel Alvarado
**VersiÃ³n**: 2.0 (2025)
